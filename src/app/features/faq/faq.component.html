<div class="faq d-flex pb-32 flex-col items-center">
  <section class="faq-header d-flex flex-col items-center justify-center">
    <h1 class="faqTitle worksTitle">FAQ</h1>

    <div class="faq-categories d-flex items-start">
      @for (cat of categories; track $index) {
      <button [class.active]="selectedIndex === $index" (click)="selectCategory($index)"
        class="category p-10 regularSemiText">
        {{ cat }}
      </button>
      }
    </div>
  </section>
  <section class="faq-list d-flex flex-col items-center">
    @for (faq of filteredFaqs; track $index) {
    <div class="faq-item">
      <div class="faq-question d-flex justify-between" (click)="toggleFaq($index)">
        <span class="subtitle">{{ faq.question }}</span>
        <span class="faq-icon">{{
          openIndex === $index ? "−" : "+"
          }}</span>
      </div>
      @if (openIndex === $index) {
      <div class="faq-answer color-text-gray regularText mt-16">
        {{ faq.answer }}
      </div>
      }
    </div>
    }
  </section>

  <section class="faq-signUp d-flex flex-col items-center">
    <h2 class="worksTitle color-background">Still have questions?</h2>

    <div class="faq-signUp-buttons d-flex items-center">
      <button class="btn-primary regularText" (click)="openContactModal()">Contact support</button>
    </div>
  </section>

  <!-- Contact Modal -->
  @if (isModalOpen) {
  <div class="modal-overlay" (click)="closeContactModal()">
    <div class="modal-container" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2 class="modal-title">Contact Support</h2>
        <button class="modal-close" (click)="closeContactModal()">
          <span class="close-icon">×</span>
        </button>
      </div>

      <div class="modal-body">
        @if (!showSuccess) {
        <form class="contact-form">
          <div class="form-group">
            <label for="email" class="form-label">Your Email</label>
            <input type="email" id="email" class="form-input" placeholder="your.email@example.com"
              [(ngModel)]="contactForm.email" name="email" [disabled]="isLoading" required />
          </div>

          <div class="form-group">
            <label for="subject" class="form-label">Subject</label>
            <input type="text" id="subject" class="form-input" placeholder="How can we help you?"
              [(ngModel)]="contactForm.subject" name="subject" [disabled]="isLoading" required />
          </div>

          <div class="form-group">
            <label for="message" class="form-label">Message</label>
            <textarea id="message" class="form-textarea" placeholder="Please describe your issue or question..."
              [(ngModel)]="contactForm.message" name="message" [disabled]="isLoading" rows="6" required></textarea>
          </div>

          @if (showError) {
          <div class="error-message">
            <span class="error-icon">⚠</span>
            <span>{{ errorMessage }}</span>
          </div>
          }

          <div class="form-actions">
            <button type="button" class="btn-secondary" (click)="closeContactModal()" [disabled]="isLoading">
              Cancel
            </button>
            <button type="submit" class="btn-primary" (click)="submitContactForm()" [disabled]="isLoading">
              @if (isLoading) {
              <span class="loading-spinner"></span>
              <span>Sending...</span>
              } @else {
              <span>Send Message</span>
              }
            </button>
          </div>
        </form>
        } @else {
        <div class="success-message">
          <div class="success-icon">✓</div>
          <h3 class="success-title">Message Sent Successfully!</h3>
          <p class="success-text">
            We've received your message and will get back to you at
            <strong>{{ contactForm.email }}</strong> as soon as possible.
          </p>
        </div>
        }
      </div>
    </div>
  </div>
  }
</div>